<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Carga vs VMP</title>
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
  <script>
    google.charts.load('current', { packages: ['corechart'] });
    google.charts.setOnLoadCallback(drawChart);

    async function drawChart() {
      try {
        const response = await fetch('https://script.google.com/macros/s/AKfycbz1UMEtWPPXua2EY_CVuCoXjAl414Y9QaooxqBDw5mrvLParCWtVhvl-8w0WpLkCkOzEA/exec');
        const rawData = await response.json();

        const data = google.visualization.arrayToDataTable(rawData);

        const options = {
          title: 'Carga vs VMP',
          hAxis: { title: 'VMP (m/s)' },
          vAxis: { title: 'Carga (Kg)' },
          legend: { position: 'bottom' },
          pointSize: 5,
          series: {
            0: { color: 'blue' },
            1: { color: 'red' }
          },
          trendlines: {
            0: {
              type: 'linear',
              color: 'blue',
              labelInLegend: 'Tendencia Serie 1',
              showR2: true,
              visibleInLegend: true
            },
            1: {
              type: 'linear',
              color: 'red',
              labelInLegend: 'Tendencia Serie 2',
              showR2: true,
              visibleInLegend: true
            }
          }
        };

        const chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));
        chart.draw(data, options);

      } catch (error) {
        console.error('Error cargando los datos o dibujando el gráfico:', error);
        document.getElementById('chart_div').innerText = 'Error cargando los datos o dibujando el gráfico.';
      }
    }
  </script>
</head>
<body>
  <div id="chart_div" style="width:100%; height:500px;"></div>
</body>
</html>



